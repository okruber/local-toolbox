# ABOUTME: Pipeline configuration for the Pokedex ETL job.
# ABOUTME: Defines sources, destinations, and extraction parameters.

pipeline:
  name: pokedex_etl
  schedule: "@daily"
  start_date: "2024-01-01"

paths:
  raw_data: /opt/airflow/data/raw
  database: /opt/airflow/dwh/pokedex.duckdb
  dbt_project: /opt/airflow/dbt_project

sources:
  pokemon:
    base_url: https://pokeapi.co/api/v2/pokemon
    id_range:
      start: 1
      end: 386  # Gen 1-3: Kanto (1-151), Johto (152-251), Hoenn (252-386)
    output_file: pokemon.json
    fields:
      - id
      - name
      - height
      - weight
      - base_experience
    nested_fields:
      types: "types[*].type.name"

  types:
    base_url: https://pokeapi.co/api/v2/type
    fetch_all: true
    output_file: types.json
    fields:
      - id
      - name
    nested_fields:
      generation: "generation.name"
      move_damage_class: "move_damage_class.name"

destinations:
  raw_pokemon:
    source: pokemon
    table_name: raw_pokemon
  raw_types:
    source: types
    table_name: raw_types
